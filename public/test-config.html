<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Frontend Configuration Test - Riya Collections</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f5f5;
        }
        .container {
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .status {
            padding: 10px;
            margin: 10px 0;
            border-radius: 4px;
        }
        .success {
            background-color: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }
        .error {
            background-color: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }
        .info {
            background-color: #d1ecf1;
            color: #0c5460;
            border: 1px solid #bee5eb;
        }
        pre {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 4px;
            overflow-x: auto;
            font-size: 12px;
        }
        .test-section {
            margin: 20px 0;
            padding: 15px;
            border: 1px solid #ddd;
            border-radius: 4px;
        }
        .test-section h3 {
            margin-top: 0;
            color: #333;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Frontend Configuration Test</h1>
        <p>This page tests the frontend configuration system for the integrated Riya Collections application.</p>
        
        <div id="loading" class="status info">
            Loading configuration...
        </div>
        
        <div class="test-section">
            <h3>Configuration Loading Test</h3>
            <div id="config-status"></div>
        </div>
        
        <div class="test-section">
            <h3>Environment Detection</h3>
            <div id="environment-info"></div>
        </div>
        
        <div class="test-section">
            <h3>API Configuration</h3>
            <div id="api-info"></div>
        </div>
        
        <div class="test-section">
            <h3>Feature Flags</h3>
            <div id="features-info"></div>
        </div>
        
        <div class="test-section">
            <h3>Utility Functions Test</h3>
            <div id="utils-test"></div>
        </div>
        
        <div class="test-section">
            <h3>Configuration Objects</h3>
            <div id="config-objects"></div>
        </div>
    </div>

    <!-- Load the configuration script -->
    <script src="/assets/js/config.js"></script>
    
    <script>
        // Test configuration loading
        function runTests() {
            const loading = document.getElementById('loading');
            
            try {
                // Test 1: Configuration Loading
                const configStatus = document.getElementById('config-status');
                if (window.API_CONFIG && window.APP_CONFIG && window.UI_CONFIG && window.FEATURES) {
                    configStatus.innerHTML = '<div class="status success">✓ All configuration objects loaded successfully</div>';
                } else {
                    configStatus.innerHTML = '<div class="status error">✗ Some configuration objects are missing</div>';
                }
                
                // Test 2: Environment Detection
                const envInfo = document.getElementById('environment-info');
                const environment = CONFIG_UTILS.getEnvironment();
                const isDev = CONFIG_UTILS.isDevelopment();
                const isProd = CONFIG_UTILS.isProduction();
                
                envInfo.innerHTML = `
                    <p><strong>Environment:</strong> ${environment}</p>
                    <p><strong>Is Development:</strong> ${isDev}</p>
                    <p><strong>Is Production:</strong> ${isProd}</p>
                    <p><strong>Debug Mode:</strong> ${window.ENVIRONMENT?.DEBUG_MODE || false}</p>
                `;
                
                // Test 3: API Configuration
                const apiInfo = document.getElementById('api-info');
                const apiBaseUrl = CONFIG_UTILS.getConfig('api.BASE_URL', 'Not found');
                const sampleEndpoint = CONFIG_UTILS.getApiUrl('/products', { id: 123 });
                
                apiInfo.innerHTML = `
                    <p><strong>API Base URL:</strong> ${apiBaseUrl}</p>
                    <p><strong>Sample Endpoint:</strong> ${sampleEndpoint}</p>
                    <p><strong>Timeout:</strong> ${CONFIG_UTILS.getConfig('api.TIMEOUT', 'Not set')}ms</p>
                `;
                
                // Test 4: Feature Flags
                const featuresInfo = document.getElementById('features-info');
                const wishlistEnabled = CONFIG_UTILS.isFeatureEnabled('WISHLIST');
                const razorpayEnabled = CONFIG_UTILS.isFeatureEnabled('PAYMENT_METHODS.RAZORPAY');
                const codEnabled = CONFIG_UTILS.isFeatureEnabled('PAYMENT_METHODS.COD');
                
                featuresInfo.innerHTML = `
                    <p><strong>Wishlist:</strong> ${wishlistEnabled ? 'Enabled' : 'Disabled'}</p>
                    <p><strong>Razorpay Payment:</strong> ${razorpayEnabled ? 'Enabled' : 'Disabled'}</p>
                    <p><strong>COD Payment:</strong> ${codEnabled ? 'Enabled' : 'Disabled'}</p>
                `;
                
                // Test 5: Utility Functions
                const utilsTest = document.getElementById('utils-test');
                const breakpoint = CONFIG_UTILS.getCurrentBreakpoint();
                const testStorage = 'test_config_value';
                
                // Test storage functions
                CONFIG_UTILS.setStorageItem('test_key', testStorage);
                const retrievedValue = CONFIG_UTILS.getStorageItem('test_key', 'default');
                CONFIG_UTILS.removeStorageItem('test_key');
                const removedValue = CONFIG_UTILS.getStorageItem('test_key', 'removed');
                
                utilsTest.innerHTML = `
                    <p><strong>Current Breakpoint:</strong> ${breakpoint}</p>
                    <p><strong>Storage Test:</strong> Set '${testStorage}', Retrieved '${retrievedValue}', After removal '${removedValue}'</p>
                    <div class="status ${retrievedValue === testStorage && removedValue === 'removed' ? 'success' : 'error'}">
                        ${retrievedValue === testStorage && removedValue === 'removed' ? '✓ Storage functions working correctly' : '✗ Storage functions failed'}
                    </div>
                `;
                
                // Test 6: Configuration Objects
                const configObjects = document.getElementById('config-objects');
                const configSummary = {
                    'API_CONFIG': Object.keys(window.API_CONFIG || {}).length,
                    'APP_CONFIG': Object.keys(window.APP_CONFIG || {}).length,
                    'UI_CONFIG': Object.keys(window.UI_CONFIG || {}).length,
                    'FEATURES': Object.keys(window.FEATURES || {}).length,
                    'ENVIRONMENT': Object.keys(window.ENVIRONMENT || {}).length,
                    'CONFIG_UTILS': Object.keys(window.CONFIG_UTILS || {}).length
                };
                
                let summaryHtml = '<ul>';
                for (const [key, count] of Object.entries(configSummary)) {
                    summaryHtml += `<li><strong>${key}:</strong> ${count} properties</li>`;
                }
                summaryHtml += '</ul>';
                
                configObjects.innerHTML = summaryHtml;
                
                // Hide loading indicator
                loading.style.display = 'none';
                
                console.log('Configuration test completed successfully');
                console.log('Configuration objects:', {
                    API_CONFIG: window.API_CONFIG,
                    APP_CONFIG: window.APP_CONFIG,
                    UI_CONFIG: window.UI_CONFIG,
                    FEATURES: window.FEATURES,
                    ENVIRONMENT: window.ENVIRONMENT
                });
                
            } catch (error) {
                loading.innerHTML = '<div class="status error">✗ Configuration test failed: ' + error.message + '</div>';
                console.error('Configuration test error:', error);
            }
        }
        
        // Wait for configuration to load
        if (typeof window.configReady !== 'undefined') {
            window.configReady.then(runTests);
        } else {
            // Fallback: run tests after a short delay
            setTimeout(runTests, 1000);
        }
        
        // Also listen for the configLoaded event
        window.addEventListener('configLoaded', function(event) {
            console.log('Configuration loaded event received:', event.detail);
            runTests();
        });
    </script>
</body>
</html>