# Apache Configuration for Riya Collections - Development Environment
# This configuration is optimized for local development

<VirtualHost *:80>
    ServerName localhost
    ServerAlias riya-collections.local
    DocumentRoot /path/to/riya-collections/public
    
    # Development-friendly settings
    LogLevel debug
    ErrorLog ${APACHE_LOG_DIR}/riya-collections-dev-error.log
    CustomLog ${APACHE_LOG_DIR}/riya-collections-dev-access.log combined
    
    # Enable all Apache modules for development
    <Directory /path/to/riya-collections/public>
        Options Indexes FollowSymLinks MultiViews
        AllowOverride All
        Require all granted
        
        # Development-specific directives
        DirectoryIndex index.php index.html
        
        # Enable .htaccess processing
        AllowOverride All
    </Directory>
    
    # Development asset handling - no caching
    <LocationMatch "\.(css|js|png|jpg|jpeg|gif|svg|webp|woff|woff2|ttf|otf|eot|ico)$">
        Header set Cache-Control "no-cache, no-store, must-revalidate"
        Header set Pragma "no-cache"
        Header set Expires 0
    </LocationMatch>
    
    # Development CORS - Allow all origins
    <LocationMatch "^/api/">
        Header always set Access-Control-Allow-Origin "*"
        Header always set Access-Control-Allow-Methods "GET, POST, PUT, DELETE, OPTIONS"
        Header always set Access-Control-Allow-Headers "Content-Type, Authorization, X-Requested-With"
        Header always set Access-Control-Allow-Credentials "true"
    </LocationMatch>
    
    # Development error pages - Show detailed errors
    ErrorDocument 404 /index.php
    ErrorDocument 500 /index.php
    
    # Development PHP settings
    <IfModule mod_php7.c>
        php_admin_value error_reporting "E_ALL"
        php_admin_flag display_errors On
        php_admin_flag display_startup_errors On
        php_admin_value memory_limit "512M"
        php_admin_value max_execution_time "120"
        php_admin_value upload_max_filesize "10M"
        php_admin_value post_max_size "10M"
    </IfModule>
    
    # Development security - Relaxed
    <Directory /path/to/riya-collections/public>
        # Allow access to all files for development
        <Files ".env*">
            Require all denied
        </Files>
        
        <Files "*.log">
            Require all denied
        </Files>
    </Directory>
    
    # Development rewrite rules
    RewriteEngine On
    
    # API routes
    RewriteCond %{REQUEST_URI} ^/api/
    RewriteCond %{REQUEST_FILENAME} !-f
    RewriteCond %{REQUEST_FILENAME} !-d
    RewriteRule ^(.*)$ /index.php [QSA,L]
    
    # Static assets
    RewriteCond %{REQUEST_FILENAME} -f
    RewriteRule \.(css|js|png|jpg|jpeg|gif|svg|webp|woff|woff2|ttf|otf|eot|ico|pdf)$ - [L]
    
    # Frontend SPA routes
    RewriteCond %{REQUEST_FILENAME} !-f
    RewriteCond %{REQUEST_FILENAME} !-d
    RewriteCond %{REQUEST_URI} !^/api/
    RewriteRule ^(.*)$ /index.php [QSA,L]
</VirtualHost>

# Development SSL configuration (optional)
<IfModule mod_ssl.c>
    <VirtualHost *:443>
        ServerName localhost
        ServerAlias riya-collections.local
        DocumentRoot /path/to/riya-collections/public
        
        # SSL Configuration for development (self-signed certificates)
        SSLEngine on
        SSLCertificateFile /path/to/ssl/localhost.crt
        SSLCertificateKeyFile /path/to/ssl/localhost.key
        
        # Development SSL settings - Less strict
        SSLProtocol all -SSLv2 -SSLv3
        SSLCipherSuite HIGH:!aNULL:!MD5
        
        # Include all the same directives as HTTP virtual host
        Include /path/to/this/config/common-development-directives.conf
    </VirtualHost>
</IfModule>

# Development-specific modules
<IfModule mod_rewrite.c>
    RewriteEngine On
</IfModule>

<IfModule mod_headers.c>
    # Development headers - Permissive CORS
    Header always set Access-Control-Allow-Origin "*"
    Header always set Access-Control-Allow-Methods "GET, POST, PUT, DELETE, OPTIONS, PATCH"
    Header always set Access-Control-Allow-Headers "Content-Type, Authorization, X-Requested-With, X-Request-ID"
</IfModule>

# Development compression - Disabled for faster reload
<IfModule mod_deflate.c>
    # Disable compression in development for faster debugging
    SetEnv no-gzip 1
</IfModule>

# Development caching - Disabled
<IfModule mod_expires.c>
    ExpiresActive Off
</IfModule>

# Development file limits - Generous
<IfModule mod_php7.c>
    php_admin_value upload_max_filesize "50M"
    php_admin_value post_max_size "50M"
    php_admin_value max_file_uploads "20"
    php_admin_value memory_limit "1G"
    php_admin_value max_execution_time "300"
</IfModule>